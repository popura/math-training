\section{線形代数の基礎 \label{sec:linalg}}

\subsection{連立方程式 \label{linalg:linear_system}}

  \vspace{1mm}
  \begin{enumerate}[label=(\roman*)]
    \item
    \begin{equation}
      \matsym{A} =
        \begin{pmatrix}
          -2 & -4 & -3 \\
           3 &  3 & -4 \\
          -5 &  2 &  3
        \end{pmatrix},
      \vecsym{b} =
        \begin{pmatrix}
          -29 \\
           12 \\
          -17
        \end{pmatrix},
      \vecsym{x} \in \numset{R}^3
    \end{equation}
    とする．
    このとき，方程式 $\matsym{A} \vecsym{x} - \vecsym{b} = \vecsym{0}$ を解け．
    
    \item
    \begin{equation}
      \matsym{A} =
        \begin{pmatrix}
           1 & 1 \\ 1 & -1 \\ 0 & 1
        \end{pmatrix},
      \vecsym{b} =
        \begin{pmatrix}
           1 \\
           1 \\
           2
        \end{pmatrix},
      \vecsym{x} \in \numset{R}^2
    \end{equation}
    とする．
    \begin{itemize}
      \item このとき，方程式 $\matsym{A} \vecsym{x} - \vecsym{b} = \vecsym{0}$ を解け．
      \item $n$ 次元ベクトル $\vecsym{v} = \tp{(v_1, \cdots, v_n)}$ のノルム $\| \vecsym{v} \|$ を
        $\| \vecsym{v} \| = \sqrt{\sum_{i=1}^n v_i^2}$ とする．
        $\|\matsym{A} \vecsym{x} - \vecsym{b} \|$ が最小となる $\vecsym{x}$ を求めよ．
    \end{itemize}
    
    \item
    \begin{equation}
      \matsym{A} =
        \begin{pmatrix}
          2 & 4 & 1 & -1 \\
          1 & 2 & -1 & 1 \\
          2 & 1 & 1 & 2 \\
          1 & 3 & 2 & -3
        \end{pmatrix},
      \vecsym{b} =
        \begin{pmatrix}
          1 \\ 2 \\ -2 \\ 0
        \end{pmatrix},
      \vecsym{x} \in \numset{R}^4
    \end{equation}
    とする．
    \begin{itemize}
      \item このとき，方程式 $\matsym{A} \vecsym{x} - \vecsym{b} = \vecsym{0}$ を解け．
      \item $n$ 次元ベクトル $\vecsym{v} = \tp{(v_1, \cdots, v_n)}$ のノルム $\|\vecsym{v}\|$ を
        $\|\vecsym{v}\| = \sqrt{\sum_{i=1}^n v_i^2}$ とする．
        $\matsym{A} \vecsym{x} - \vecsym{b} = \vecsym{0}$の解$\vecsym{x}$のうち，$\|\vecsym{x}\|$が最小となるものを求めよ．
    \end{itemize}
  \end{enumerate}

\subsection{線形変換}
  $\vecsym{x}$，$\vecsym{y}$を互いに線形独立な縦ベクトルとする．
  いま$\vecsym{y}$を，
  \begin{equation}
    \vecsym{y} = a \vecsym{x} + \vecsym{x}_\perp
  \end{equation}
  のように表したい．
  ここで，$a$はスカラー，$\vecsym{x}_{\perp}$は$\vecsym{x}$と直交するベクトルを表す．
  すなわち，$\tp{\vecsym{x}} \vecsym{x}_{\perp} = 0$である．
  \begin{enumerate}[label=(\roman*)]
    \item $a$を求めよ．
    \item $\vecsym{y}$から$a \vecsym{x}$を得る演算は，ある行列$\matsym{A}$を用いて，
      $\matsym{A}\vecsym{y} = a \vecsym{x}$とかくことができる．$\matsym{A}$を求めよ．
  \end{enumerate}

\subsection{行列のランク}
  2つの行列$\matsym{A}$，$\matsym{B}$の積として，
  $\matsym{C}=\matsym{A}\matsym{B}$で表される行列$\matsym{C}$のランクについて考える．
  ただし，行列$\matsym{C}$のサイズは$5\times 4$である．

  \begin{enumerate}[label=(\roman*)]
    \item 行列$\matsym{A}$，$\matsym{B}$として，
      それぞれ$5\times 1$，$1\times 4$の適当な行列を自分で考え，$\matsym{C}$を計算しなさい．
      ただし，$\matsym{A}$，$\matsym{B}$は零行列（すべての要素が0の行列）ではないものとします．
    \item (i)のとき、行列$\matsym{C}$のランクを求めなさい．
      理由をつけて答えても，(i)の答えを階段化するなどして答えても結構です．
    \item 行列$\matsym{A}$，$\matsym{B}$として，
      それぞれ$5\times 2$，$2\times 4$の適当な行列を自分で考え，$\matsym{C}$を計算しなさい．
      ただし，$\matsym{A}$，$\matsym{B}$はフルランクの行列（$m\times n$行列のランクが$m$と$n$の小さいほうに等しいとき，この行列をフルランクであるという）であるものとします．
    \item (iii)のとき、行列$\matsym{C}$のランクを求めなさい．
      理由をつけて答えても，(iii)の答えを階段化するなどして答えても結構です．
    \item 行列$\matsym{A}$，$\matsym{B}$が，
      それぞれ$5\times N$，$N\times 4$のサイズであったとき，
      行列$\matsym{C}$のランクがいくつになるか答えなさい．証明なしでも結構です．
      ただし，$N\in \numset{N}$で，$\matsym{A}$，$\matsym{B}$はフルランクの行列であるとします．
      必要であれば、$N$で場合分けしてください．
  \end{enumerate}

\subsection{固有値，固有ベクトル}
    4次元ベクトル $\vecsym{x} = \begin{pmatrix} a \\ b \\ c \\ d \end{pmatrix}$ に対し，
    要素を巡回的にシフトした $\vecsym{y} = \begin{pmatrix} b \\ c \\ d \\ a \end{pmatrix}$を考えます．
    \begin{enumerate}[label=(\roman*)]
      \item $\vecsym{y} = \matsym{P}\vecsym{x}$ となるような，4x4の行列 $\matsym{P}$ を求めてください．
      \item $\matsym{P}v = \lambda \vecsym{v}$ ($\lambda$はスカラー) となるようなベクトル $\vecsym{v}$，
        すなわち，$\matsym{P}$ の固有ベクトルをすべて求めてください．
    \end{enumerate}

\subsection{行列式と逆行列の存在条件}
    $i, j \in \numset{N}, a_{ij} \in \numset{C}$ のとき，
    行列
    \begin{equation}
      \matsym{A}=
        \begin{pmatrix}
          a_{11} & a_{12} & \cdots & a_{1n} \\
          a_{21} & a_{22} & \cdots & a_{2n} \\
          \vdots & \vdots & & \vdots \\
          a_{n1} & a_{n2} & \cdots & a_{nn}
        \end{pmatrix}
    \end{equation}
    の行列式を
    \begin{equation}
      \det{(\matsym{A})} =
        \begin{vmatrix}
          a_{11} & a_{12} & \cdots & a_{1n} \\
          a_{21} & a_{22} & \cdots & a_{2n} \\
          \vdots & \vdots & & \vdots \\
          a_{n1} & a_{n2} & \cdots & a_{nn}
        \end{vmatrix}
    \end{equation}
    と表す．
    ここで，
    $i \in \numset{N}$とし，$x_i \in \numset{C}$の冪からなる行列
    \begin{equation}
      \matsym{V} =
        \begin{pmatrix}
          1 & 1 & 1 & 1 \\
          x_1 & x_2 & x_3 & x_4 \\
          x_1^2 & x_2^2 & x_3^2 & x_4^2 \\
          x_1^3 & x_2^3 & x_3^3 & x_4^3
        \end{pmatrix}
    \end{equation}
    を考える．
    \begin{enumerate}[label=(\roman*)]
      \item $\det{(\matsym{V})}$を計算せよ．
      \item $\matsym{V}$の逆行列，
        すなわち，$\matsym{V}\matsym{V}^{-1}=\matsym{V}^{-1}\matsym{V}=\matsym{I}$が
        存在するための条件を示してください．
    \end{enumerate}

\subsection{逆行列}
    \begin{equation}
      \matsym{H} =
        \begin{pmatrix}
                     1 & \frac{1}{2} & \frac{1}{3} \\[1.5ex]
           \frac{1}{2} & \frac{1}{3} & \frac{1}{4} \\[1.5ex]
           \frac{1}{3} & \frac{1}{4} & \frac{1}{5}
        \end{pmatrix}
    \end{equation}
    とする．
    \begin{enumerate}[label=(\roman*)]
      \item $\matsym{H}$の逆行列$\matsym{H}^{-1}$をコンピュータで
        （MATLABならinv(), Pythonならnumpy.linalg.inv()等の関数を用いて）計算せよ．
        
      \item $\matsym{H}$の逆行列$\matsym{H}^{-1}$を手計算せよ．
    \end{enumerate}

\subsection{逆行列，固有値分解}
  ベクトル$\vecsym{x} \in \numset{R}^2$を原点中心に$\theta$だけ（反時計回りに）回転させたベクトル$\vecsym{y}$は，
  行列$\matsym{R}_\theta$を用いて$\vecsym{y} = \matsym{R}_\theta \vecsym{x}$と与えられる．
  \begin{enumerate}[label=(\roman*)]
    \item $\matsym{R}_\theta$を求めよ．
    \item $\matsym{R}_\theta$の逆行列を求めよ．
    \item $\matsym{R}_\theta$の固有値，固有ベクトルを求めよ．
    \item 正則行列$\matsym{U}$および対角行列$\matsym{\Lambda}$を用いて，
      $\matsym{R}_\theta = \matsym{U}\matsym{\Lambda} \matsym{U}^{-1}$の形で$\matsym{R}_\theta$を表せ．
  \end{enumerate}

\subsection{エルミート行列の性質}
  エルミート行列$\matsym{A}$の固有値分解$\matsym{A} = \matsym{U}\matsym{\Lambda}\matsym{U}^{-1}$を考える．
  \begin{enumerate}[label=(\roman*)]
    % \item エルミート行列$\matsym{A}$の異なる固有値に対応する固有ベクトルが，任意の内積について直交することを示せ．
    \item 任意の複素ベクトル$\vecsym{v}=\tp{(v_1, \cdots, v_n)}$のとき，
      $\htp{\vecsym{v}} \vecsym{v} \geq 0$を証明せよ．
      ここで， $\htp{\cdot}$ はエルミート転置を表す．
    \item もしくはエルミート行列の固有値$\lambda$が実数になることを証明せよ．
    \item エルミート行列$\matsym{A}$の固有値分解が
      $\matsym{A} = \matsym{U}\matsym{\Lambda}\htp{\matsym{U}}$ として与えられることを示せ．
    \item フルランクを持つエルミート行列$\matsym{A}$の逆行列$\matsym{A}^{-1}$が，
      $\matsym{A}^{-1} = \matsym{U}\matsym{\Lambda}^{-1}\htp{\matsym{U}}$として与えられることを示せ．
  \end{enumerate}

\subsection{特異値分解 \label{linalg:svd}}
  行列$\matsym{A}$は，各行が直交する行列$\matsym{U}, \matsym{V}$，
  および対角行列$\matsym{\Sigma}$を用いて
  $\matsym{A}=\matsym{U}\matsym{\Sigma}\htp{\matsym{V}}$の形に分解できる．
  これを特異値分解と呼ぶ．ここで，$\htp{\cdot}$はエルミート転置を表す．
  \begin{enumerate}[label=(\roman*)]
    \item
      \begin{equation}
        \matsym{A} =
          \begin{pmatrix}
            1 & 1 \\
            1 & -1 \\
            0 & 1
          \end{pmatrix}
      \end{equation}
      の特異値分解を求めよ．
    \item
      \begin{equation}
        \matsym{A} =
          \begin{pmatrix}
            2 & 4 & 1 &-1 \\
            1 & 2 & -1 & 1 \\
            2 & 1 & 1 & 2 \\
            1 & 3 & 2 & -3
          \end{pmatrix}
      \end{equation}の特異値分解を求めよ．
      ただし，この特異値分解に限り，プログラム等を用いて解答してもよい．
  \end{enumerate}

\subsection{Moore-Penroseの擬似逆行列}
  行列$\matsym{A}$について，以下の4条件
  \begin{itemize}
    \item $\matsym{A}\pinv{\matsym{A}}\matsym{A}=\matsym{A},$
    \item $\pinv{\matsym{A}}\matsym{A}\pinv{\matsym{A}}=\pinv{\matsym{A}},$
    \item $\htp{(\matsym{A}\pinv{\matsym{A}})}=\matsym{A}\pinv{\matsym{A}},$
    \item $\htp{(\pinv{\matsym{A}}\matsym{A})}=\pinv{\matsym{A}}\matsym{A}$
  \end{itemize}
  を満たす行列$\pinv{\matsym{A}}$をMoore-Penroseの擬似逆行列と呼ぶ．
  ここで，$\matsym{A}$が正則行列ならば，$\pinv{\matsym{A}}=\matsym{A}^{-1}$を満たす．
  また，$\matsym{A}$の特異値分解が
  $\matsym{A}=\matsym{U}\matsym{\Sigma}\htp{\matsym{V}}$として与えられるとき，
  $\pinv{\matsym{A}}=\matsym{V}\pinv{\matsym{\Sigma}}\htp{\matsym{U}}$が成り立つ．
  \ref{linalg:svd}の結果を用いて以下の問いに答えよ．
  \begin{enumerate}[label=(\roman*)]
    \item
      \begin{equation}
        \matsym{A} =
          \begin{pmatrix}
            1 & 1 \\
            1 & -1 \\
            0 & 1
          \end{pmatrix}
      \end{equation}
      について，$\pinv{\matsym{A}}$を求めよ．
      また，$\vecsym{b} = \begin{pmatrix} 1 \\ 1 \\ 2 \end{pmatrix}$のとき，
      $\pinv{\matsym{A}} \vecsym{b}$を計算し，
      その結果を\ref{linalg:linear_system}(ii)で計算した$\vecsym{x}$と比較せよ．
  
    \item
      \begin{equation}
        \matsym{A} =
          \begin{pmatrix}
            2 & 4 & 1 & -1 \\
            1 & 2 & -1 & 1 \\
            2 & 1 & 1 & 2 \\
            1 & 3 & 2 & -3
          \end{pmatrix}
      \end{equation}
      について，$\pinv{\matsym{A}}$を求めよ．
      また，$\vecsym{b}=\begin{pmatrix} 1 \\ 2 \\ -2 \\ 0 \end{pmatrix}$のとき，
      $\pinv{\matsym{A}} b$を計算し，その結果を\ref{linalg:linear_system}(iii)で計算した$\vecsym{x}$と比較せよ．
      ただし，この計算に限り，プログラム等を利用して解答してもよい．
  \end{enumerate}

\subsection{トレース}
    $i$行$j$列要素が$a_{ij}$である$n$次正方行列$\matsym{A}=(a_{ij})$の
    トレース$\trace(\matsym{A})$（跡，対角和）を
    $\trace(\matsym{A}) = \sum_i^n a_{ii}$
    と定義する．
    \begin{enumerate}[label=(\roman*)]
      \item $n$次正方行列$\matsym{A}$と，それに相似な行列
        $\matsym{D} = \matsym{P}^{-1}\matsym{A}\matsym{P}$
        （ただし，$\matsym{P}$は$n$次正則行列）について，
        $\trace(\matsym{A}) = \trace(\matsym{D})$が成り立つことを証明せよ．
      \item $n$次正方行列${\boldsymbol A}$の固有値を$\lambda_i\ (i=1,\ldots,n)$とすると，
        $\trace(\matsym{A}) = \sum_i \lambda_i$が成り立つことを証明せよ．
      \item $n$次正方行列$\matsym{A}$，$\matsym{B}$に対し，
        $\trace(\matsym{A}\matsym{B}) = \trace(\matsym{B}\matsym{A})$が成り立つことを証明せよ．
    \end{enumerate}

\subsection{離散畳み込みとDFT}
  離散領域での畳み込みの式$y_n=\sum^{K-1}_{k=0}a_kx_{n-k}$
  の行列表現について以下の問いに答えよ．ただし，以後は$K=4$であり，
  \begin{equation}
    \vecsym{x} = \begin{pmatrix}x_1\\x_2\\x_3\\x_4\end{pmatrix},
    \vecsym{y} = \begin{pmatrix}y_1\\y_2\\y_3\\y_4\end{pmatrix}
  \end{equation}
  とする．
  \begin{enumerate}[label=(\roman*)]
    \item $x_n=0,(n \le 1)$であるとき，
      $\vecsym{y}=\matsym{L}\vecsym{x}$となるような$4\times4$の行列$\matsym{L}$を，$a_k (k=0,1,2,3)$を用いて表せ．
    \item 任意の$n$に対して$x_n=x_{n+4}$であるとき，
      $\vecsym{y}=\matsym{C}\vecsym{x}$となるような$4\times4$の行列$\matsym{C}$を，
      $a_k (k=0,1,2,3)$を用いて表せ．
    \item 行列$\matsym{F}$を以下のように定義する．ただし，$j$は虚数単位を表す．
      \begin{equation}
        \matsym{F} =
          \begin{bmatrix}
            1 &  1 &  1&  1\\
            1 &  j & -1& -j\\
            1 & -1 &  1& -1\\
            1 & -j & -1&  j
          \end{bmatrix}.
      \end{equation}
      このとき$a_k,(k=0,1,2,3)$によらず，
      $\matsym{F}\matsym{C}\matsym{F}^{-1}$が対角行列になることを示せ．
      ただし，$\matsym{F}^{-1}=\frac{1}{4}\htp{\matsym{F}}$であることを用いてよい．
      ここで，$\htp{}$はエルミート転置を表す．

      補足：計算が大変であれば，適当な$a_k$を自分で定め，
      その場合について示すのでも可とする．
      ただし，全部$0$，$1$のような簡単すぎるものは不可とする．
      せめてどれも$0$でない値を選ぶこと．
    \item $\vecsym{X}=\matsym{F}\vecsym{x}$，$\vecsym{Y}=\matsym{F}\vecsym{y}$を定義すると，
      (ii)のように$\vecsym{y}=\matsym{C}\vecsym{x}$であるとき，
      $\matsym{Y}$を$\matsym{X}$，$\matsym{F}$，$\matsym{C}$で表せ．
      $\matsym{Y}$の第$n$成分$Y_n$は，$\matsym{X}$の第$n$成分$X_n$を用いて$Y_n=D_nX_n$，
      と表すことができることを示せ．また，$D_1,D_2,D_3,D_4$を求めよ．

      補足：(iii)のように適当な$X_k$，$Y_k$を自身で定めることも可とする．
    \end{enumerate}

\subsection{深層学習？}
    $k \in \numset{N}$層の全結合ニューラルネットワーク$f$は，
    \begin{equation}
    f(\vecsym{x}) =
      f_k(\matsym{W}_k
        f_{k-1}(\matsym{W}_{k-1}
          f_{k-2}(\cdots \matsym{W}_2
            f_1(\matsym{W}_1
              \vecsym{x} + \vecsym{b}_1)
            + \vecsym{b}_2) \cdots)
          + \vecsym{b}_{k-1})
        + \vecsym{b}_k)
    \end{equation}
    として与えられる．
    ここで，$\matsym{W}_n (1 \le n \le k)$は実行列，
    $\vecsym{b}_n, \vecsym{x}$はそれぞれ実列ベクトルとし，
    積や和が定義できるサイズを持つものとする．
    また，$f_n(\vecsym{x})$は，
    与えられたベクトルと同じ次元を持つベクトルを返す微分可能な関数である．

    関数$f_n(\vecsym{x})$が$f_n(\vecsym{x}) = \vecsym{x}$として与えられるとき，
    $k$層のニューラルネットワークと等価な$1$層のニューラルネットワークが存在することを示せ

